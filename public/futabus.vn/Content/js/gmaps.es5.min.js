/*!
 * GMaps.js v0.4.6
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2013, Gustavo Leon
 * Released under the MIT License.
 */
var travelMode,unitSystem;if(!(typeof google=="object"&&window.google.maps))throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true.";var extend_object=function(n,t){var i;if(n===t)return n;for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},replace_object=function(n,t){var i;if(n===t)return n;for(i in t)t.hasOwnProperty(i)&&n[i]!=undefined&&(n[i]=t[i]);return n},array_map=function(n,t){var f=Array.prototype.slice.call(arguments,2),r=[],e=n.length,i,u;if(Array.prototype.map&&n.map===Array.prototype.map)r=Array.prototype.map.call(n,function(n){var i=f;return i.splice(0,0,n),t.apply(this,i)});else for(i=0;i<e;i++)u=f,u.splice(0,0,n[i]),r.push(t.apply(this,u));return r},array_flat=function(n){for(var i=[],t=0;t<n.length;t++)i=i.concat(n[t]);return i},coordsToLatLngs=function(n,t){var i=n[0],r=n[1];return t&&(i=n[1],r=n[0]),new window.google.maps.LatLng(i,r)},arrayToLatLng=function arrayToLatLng(n,t){for(var i=0;i<n.length;i++)n[i]=n[i].length>0&&typeof n[i][0]!="number"?arrayToLatLng(n[i],t):coordsToLatLngs(n[i],t);return n},getElementById=function(n,t){return n=n.replace("#",""),"jQuery"in this&&t?$("#"+n,t)[0]:document.getElementById(n)},findAbsolutePosition=function(n){var t=0,i=0;if(n.offsetParent)do t+=n.offsetLeft,i+=n.offsetTop;while(n===n.offsetParent);return[t,i]},GMaps=function(){"use strict";var n=document,t=function t(i){var v,y,f,e,c,l;if(!this)return new t(i);i.zoom=i.zoom||15;i.mapType=i.mapType||"roadmap";var u=this,r,o=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],s=["mousemove","mouseout","mouseover"],p=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],w=i.el||i.div,b=i.markerClusterer,g=google.maps.MapTypeId[i.mapType.toUpperCase()],nt=new google.maps.LatLng(i.clat,i.clng),tt=i.zoomControl||!0,k=i.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},it=k.style||"DEFAULT",rt=k.position||"TOP_LEFT",ut=i.panControl||!0,ft=i.mapTypeControl||!0,et=i.scaleControl||!0,ot=i.streetViewControl||!0,d=d||!0,h={},a={zoom:this.zoom,center:nt,mapTypeId:g},st={panControl:ut,zoomControl:tt,zoomControlOptions:{style:google.maps.ZoomControlStyle[it],position:google.maps.ControlPosition[rt]},mapTypeControl:ft,scaleControl:et,streetViewControl:ot,overviewMapControl:d};if(this.el=typeof i.el=="string"||typeof i.div=="string"?getElementById(w,i.context):w,typeof this.el=="undefined"||this.el===null)throw"No element defined.";for(window.context_menu=window.context_menu||{},window.context_menu[u.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=i.zoom,this.registered_events={},this.el.style.width=i.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=i.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=i.enableNewStyle,r=0;r<p.length;r++)delete i[p[r]];for(i.disableDefaultUI!=!0&&(a=extend_object(a,st)),h=extend_object(a,i),r=0;r<o.length;r++)delete h[o[r]];for(r=0;r<s.length;r++)delete h[s[r]];for(this.map=new google.maps.Map(this.el,h),b&&(this.markerClusterer=b.apply(this,[this.map])),v=function(n,t){var s="",f=window.context_menu[u.el.id][n],i,h,r,e,c,o,l;for(i in f)f.hasOwnProperty(i)&&(h=f[i],s+='<li><a id="'+n+"_"+i+'" href="#">'+h.title+"<\/a><\/li>");if(getElementById("gmaps_context_menu")){for(r=getElementById("gmaps_context_menu"),r.innerHTML=s,e=r.getElementsByTagName("a"),c=e.length,i,i=0;i<c;i++)o=e[i],l=function(i){i.preventDefault();f[this.id.replace(n+"_","")].action.apply(u,[t]);u.hideContextMenu()},google.maps.event.clearListeners(o,"click"),google.maps.event.addDomListenerOnce(o,"click",l,!1);var a=findAbsolutePosition.apply(this,[u.el]),v=a[0]+t.pixel.x-15,y=a[1]+t.pixel.y-15;r.style.left=v+"px";r.style.top=y+"px";r.style.display="block"}},this.buildContextMenu=function(n,t){if(n==="marker"){t.pixel={};var i=new google.maps.OverlayView;i.setMap(u.map);i.draw=function(){var r=i.getProjection(),u=t.marker.getPosition();t.pixel=r.fromLatLngToContainerPixel(u);v(n,t)}}else v(n,t)},this.setContextMenu=function(t){var f,i,r,e;window.context_menu[u.el.id][t.control]={};i=n.createElement("ul");for(f in t.options)t.options.hasOwnProperty(f)&&(r=t.options[f],window.context_menu[u.el.id][t.control][r.name]={title:r.title,action:r.action});i.id="gmaps_context_menu";i.style.display="none";i.style.position="absolute";i.style.minWidth="100px";i.style.background="white";i.style.listStyle="none";i.style.padding="8px";i.style.boxShadow="2px 2px 6px #ccc";n.body.appendChild(i);e=getElementById("gmaps_context_menu");google.maps.event.addDomListener(e,"mouseout",function(n){n.relatedTarget&&this.contains(n.relatedTarget)||window.setTimeout(function(){e.style.display="none"},400)},!1)},this.hideContextMenu=function(){var n=getElementById("gmaps_context_menu");n&&(n.style.display="none")},y=function(n,t){google.maps.event.addListener(n,t,function(n){n==undefined&&(n=this);i[t].apply(this,[n]);u.hideContextMenu()})},f=0;f<o.length;f++)e=o[f],e in i&&y(this.map,e);for(f=0;f<s.length;f++)e=s[f],e in i&&y(this.map,e);google.maps.event.addListener(this.map,"rightclick",function(n){i.rightclick&&i.rightclick.apply(this,[n]);window.context_menu[u.el.id].map!=undefined&&u.buildContextMenu("map",n)});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){for(var t=[],i=this.markers.length,n=0;n<i;n++)t.push(this.markers[n].getPosition());this.fitLatLngBounds(t)};this.fitLatLngBounds=function(n){for(var r=n.length,i=new google.maps.LatLngBounds,t=0;t<r;t++)i.extend(n[t]);this.map.fitBounds(i)};this.setCenter=function(n,t,i){this.map.panTo(new google.maps.LatLng(n,t));i&&i()};this.getElement=function(){return this.el};this.zoomIn=function(n){n=n||1;this.zoom=this.map.getZoom()+n;this.map.setZoom(this.zoom)};this.zoomOut=function(n){n=n||1;this.zoom=this.map.getZoom()-n;this.map.setZoom(this.zoom)};c=[];for(l in this.map)typeof this.map[l]!="function"||this[l]||c.push(l);for(r=0;r<c.length;r++)(function(n,t,i){n[i]=function(){return t[i].apply(t,arguments)}})(this,this.map,c[r])};return t}(undefined);GMaps.prototype.createControl=function(n){var t=document.createElement("div"),i,r;t.style.cursor="pointer";t.style.fontFamily="Arial, sans-serif";t.style.fontSize="13px";t.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(i in n.style)t.style[i]=n.style[i];n.id&&(t.id=n.id);n.classes&&(t.className=n.classes);n.content&&(t.innerHTML=n.content);for(r in n.events)(function(t,i){google.maps.event.addDomListener(t,i,function(){n.events[i].apply(this,[this])})})(t,r);return t.index=1,t};GMaps.prototype.addControl=function(n){var i=google.maps.ControlPosition[n.position.toUpperCase()],t;return delete n.position,t=this.createControl(n),this.controls.push(t),this.map.controls[i].push(t),t};GMaps.prototype.createMarker=function(n){var o,t,u,f,e,i;if(n.lat==undefined&&n.lng==undefined&&n.position==undefined)throw"No latitude or longitude defined.";var r=this,s=n.details,h=n.fences,c=n.outside,l={position:new window.google.maps.LatLng(n.lat,n.lng),map:null};if(delete n.lat,delete n.lng,delete n.fences,delete n.outside,o=extend_object(l,n),t=new window.google.maps.Marker(o),t.fences=h,n.infoWindow)for(t.infoWindow=new window.google.maps.InfoWindow(n.infoWindow),u=["closeclick","content_changed","domready","position_changed","zindex_changed"],i=0;i<u.length;i++)(function(t,i){n.infoWindow[i]&&window.google.maps.event.addListener(t,i,function(t){n.infoWindow[i].apply(this,[t])})})(t.infoWindow,u[i]);for(f=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],e=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],i=0;i<f.length;i++)(function(t,i){n[i]&&window.google.maps.event.addListener(t,i,function(){n[i].apply(this,[this])})})(t,f[i]);for(i=0;i<e.length;i++)(function(t,i,r){n[r]&&window.google.maps.event.addListener(i,r,function(i){i.pixel||(i.pixel=t.getProjection().fromLatLngToPoint(i.latLng));n[r].apply(this,[i])})})(this.map,t,e[i]);return window.google.maps.event.addListener(t,"click",function(){this.details=s;n.click&&n.click.apply(this,[this]);t.infoWindow&&(r.hideInfoWindows(),t.infoWindow.open(r.map,t))}),window.google.maps.event.addListener(t,"rightclick",function(t){t.marker=this;n.rightclick&&n.rightclick.apply(this,[t]);window.context_menu[r.el.id].marker!=undefined&&r.buildContextMenu("marker",t)}),t.fences&&window.google.maps.event.addListener(t,"dragend",function(){r.checkMarkerGeofence(t,function(n,t){c(n,t)})}),t};GMaps.prototype.addMarker=function(n){var t;if(n.hasOwnProperty("gm_accessors_"))t=n;else if(n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")||n.position)t=this.createMarker(n);else throw"No latitude or longitude defined.";return t.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(t),this.markers.push(t),GMaps.fire("marker_added",t,this),t};GMaps.prototype.addMarkers=function(n){for(var t=0,i;i=n[t];t++)this.addMarker(i);return this.markers};GMaps.prototype.hideInfoWindows=function(){for(var t=0,n;n=this.markers[t];t++)n.infoWindow&&n.infoWindow.close()};GMaps.prototype.removeMarker=function(n){for(var t=0;t<this.markers.length;t++)if(this.markers[t]===n){this.markers[t].setMap(null);this.markers.splice(t,1);GMaps.fire("marker_removed",n,this);break}return n};GMaps.prototype.removeMarkers=function(n){for(var i,n=n||this.markers,t=0;t<this.markers.length;t++)this.markers[t]===n[t]&&this.markers[t].setMap(null);for(i=[],t=0;t<this.markers.length;t++)this.markers[t].getMap()!=null&&i.push(this.markers[t]);this.markers=i};GMaps.prototype.drawOverlay=function(n){var t=new google.maps.OverlayView,i=!0;return t.setMap(this.map),n.auto_show!=null&&(i=n.auto_show),t.onAdd=function(){var i=document.createElement("div"),r;i.style.borderStyle="none";i.style.borderWidth="0px";i.style.position="absolute";i.style.zIndex=100;i.innerHTML=n.content;t.el=i;n.layer||(n.layer="overlayLayer");var f=this.getPanes(),e=f[n.layer],u=["contextmenu","DOMMouseScroll","dblclick","mousedown"];for(e.appendChild(i),r=0;r<u.length;r++)(function(n,t){google.maps.event.addDomListener(n,t,function(n){navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all?(n.cancelBubble=!0,n.returnValue=!1):n.stopPropagation()})})(i,u[r]);google.maps.event.trigger(this,"ready")},t.draw=function(){var s=this.getProjection(),u=s.fromLatLngToDivPixel(new google.maps.LatLng(n.lat,n.lng));n.horizontalOffset=n.horizontalOffset||0;n.verticalOffset=n.verticalOffset||0;var r=t.el,f=r.children[0],e=f.clientHeight,o=f.clientWidth;switch(n.verticalAlign){case"top":r.style.top=u.y-e+n.verticalOffset+"px";break;default:case"middle":r.style.top=u.y-e/2+n.verticalOffset+"px";break;case"bottom":r.style.top=u.y+n.verticalOffset+"px"}switch(n.horizontalAlign){case"left":r.style.left=u.x-o+n.horizontalOffset+"px";break;default:case"center":r.style.left=u.x-o/2+n.horizontalOffset+"px";break;case"right":r.style.left=u.x+n.horizontalOffset+"px"}r.style.display=i?"block":"none";i||n.show.apply(this,[r])},t.onRemove=function(){var i=t.el;n.remove?n.remove.apply(this,[i]):(t.el.parentNode.removeChild(t.el),t.el=null)},this.overlays.push(t),t};GMaps.prototype.removeOverlay=function(n){for(var t=0;t<this.overlays.length;t++)if(this.overlays[t]===n){this.overlays[t].setMap(null);this.overlays.splice(t,1);break}};GMaps.prototype.removeOverlays=function(){for(var n=0,t;t=this.overlays[n];n++)t.setMap(null);this.overlays=[]};GMaps.prototype.drawPolyline=function(n){var f=[],r=n.path,e,o,t,i,s,u;if(r.length)if(r[0][0]===undefined)f=r;else for(e=0;o=r[e];e++)f.push(new window.google.maps.LatLng(o[0],o[1]));for(t={map:this.map,path:f,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight,geodesic:n.geodesic,clickable:!0,editable:!1,visible:!0},n.hasOwnProperty("clickable")&&(t.clickable=n.clickable),n.hasOwnProperty("editable")&&(t.editable=n.editable),n.hasOwnProperty("icons")&&(t.icons=n.icons),n.hasOwnProperty("zIndex")&&(t.zIndex=n.zIndex),i=new window.google.maps.Polyline(t),s=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],u=0;u<s.length;u++)(function(t,i){n[i]&&window.google.maps.event.addListener(t,i,function(t){n[i].apply(this,[t])})})(i,s[u]);return this.polylines.push(i),GMaps.fire("polyline_added",i,this),i};GMaps.prototype.removePolyline=function(n){for(var t=0;t<this.polylines.length;t++)if(this.polylines[t]===n){this.polylines[t].setMap(null);this.polylines.splice(t,1);GMaps.fire("polyline_removed",n,this);break}};GMaps.prototype.removePolylines=function(){for(var n=0,t;t=this.polylines[n];n++)t.setMap(null);this.polylines=[]};GMaps.prototype.drawCircle=function(n){var t,r,i;for(n=extend_object({map:this.map,center:new google.maps.LatLng(n.lat,n.lng)},n),delete n.lat,delete n.lng,t=new google.maps.Circle(n),r=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i=0;i<r.length;i++)(function(t,i){n[i]&&google.maps.event.addListener(t,i,function(t){n[i].apply(this,[t])})})(t,r[i]);return this.polygons.push(t),t};GMaps.prototype.drawRectangle=function(n){var u,t,r,i;for(n=extend_object({map:this.map},n),u=new google.maps.LatLngBounds(new google.maps.LatLng(n.bounds[0][0],n.bounds[0][1]),new google.maps.LatLng(n.bounds[1][0],n.bounds[1][1])),n.bounds=u,t=new google.maps.Rectangle(n),r=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i=0;i<r.length;i++)(function(t,i){n[i]&&google.maps.event.addListener(t,i,function(t){n[i].apply(this,[t])})})(t,r[i]);return this.polygons.push(t),t};GMaps.prototype.drawPolygon=function(n){var r=!1,t,u,i;for(n.hasOwnProperty("useGeoJSON")&&(r=n.useGeoJSON),delete n.useGeoJSON,n=extend_object({map:this.map},n),r==!1&&(n.paths=[n.paths.slice(0)]),n.paths.length>0&&n.paths[0].length>0&&(n.paths=array_flat(array_map(n.paths,arrayToLatLng,r))),t=new google.maps.Polygon(n),u=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i=0;i<u.length;i++)(function(t,i){n[i]&&google.maps.event.addListener(t,i,function(t){n[i].apply(this,[t])})})(t,u[i]);return this.polygons.push(t),GMaps.fire("polygon_added",t,this),t};GMaps.prototype.removePolygon=function(n){for(var t=0;t<this.polygons.length;t++)if(this.polygons[t]===n){this.polygons[t].setMap(null);this.polygons.splice(t,1);GMaps.fire("polygon_removed",n,this);break}};GMaps.prototype.removePolygons=function(){for(var n=0,t;t=this.polygons[n];n++)t.setMap(null);this.polygons=[]};GMaps.prototype.getFromFusionTables=function(n){var i=n.events,r,t,u;delete n.events;r=n;t=new google.maps.FusionTablesLayer(r);for(u in i)(function(n,t){google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})})(t,u);return this.layers.push(t),t};GMaps.prototype.loadFromFusionTables=function(n){var t=this.getFromFusionTables(n);return t.setMap(this.map),t};GMaps.prototype.getFromKML=function(n){var f=n.url,i=n.events,r,t,u;delete n.url;delete n.events;r=n;t=new google.maps.KmlLayer(f,r);for(u in i)(function(n,t){google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})})(t,u);return this.layers.push(t),t};GMaps.prototype.loadFromKML=function(n){var t=this.getFromKML(n);return t.setMap(this.map),t};GMaps.prototype.addLayer=function(n,t){var i,r,u;t=t||{};switch(n){case"weather":this.singleLayers.weather=i=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=i=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=i=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=i=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=i=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=i=new google.maps.panoramio.PanoramioLayer;i.setTag(t.filter);delete t.filter;t.click&&google.maps.event.addListener(i,"click",function(n){t.click(n);delete t.click});break;case"places":this.singleLayers.places=i=new google.maps.places.PlacesService(this.map);(t.search||t.nearbySearch)&&(r={bounds:t.bounds||null,keyword:t.keyword||null,location:t.location||null,name:t.name||null,radius:t.radius||null,rankBy:t.rankBy||null,types:t.types||null},t.search&&i.search(r,t.search),t.nearbySearch&&i.nearbySearch(r,t.nearbySearch));t.textSearch&&(u={bounds:t.bounds||null,location:t.location||null,query:t.query||null,radius:t.radius||null},i.textSearch(u,t.textSearch))}if(i!==undefined)return typeof i.setOptions=="function"&&i.setOptions(t),typeof i.setMap=="function"&&i.setMap(this.map),i};GMaps.prototype.removeLayer=function(n){if(typeof n=="string"&&this.singleLayers[n]!==undefined)this.singleLayers[n].setMap(null),delete this.singleLayers[n];else for(var t=0;t<this.layers.length;t++)if(this.layers[t]===n){this.layers[t].setMap(null);this.layers.splice(t,1);break}};GMaps.prototype.getRoutes=function(n){var r,t,i,u;switch(n.travelMode){case"bicycling":travelMode=google.maps.TravelMode.BICYCLING;break;case"transit":travelMode=google.maps.TravelMode.TRANSIT;break;case"driving":travelMode=google.maps.TravelMode.DRIVING;break;default:travelMode=google.maps.TravelMode.WALKING}unitSystem=n.unitSystem==="imperial"?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;r={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]};t=extend_object(r,n);t.origin=/string/.test(typeof n.origin)?n.origin:new google.maps.LatLng(n.origin[0],n.origin[1]);t.destination=/string/.test(typeof n.destination)?n.destination:new google.maps.LatLng(n.destination[0],n.destination[1]);t.travelMode=travelMode;t.unitSystem=unitSystem;delete t.callback;i=this;u=new google.maps.DirectionsService;u.route(t,function(t,r){if(r===google.maps.DirectionsStatus.OK)for(var u in t.routes)t.routes.hasOwnProperty(u)&&i.routes.push(t.routes[u]);n.callback&&n.callback(i.routes)})};GMaps.prototype.removeRoutes=function(){this.routes=[]};GMaps.prototype.getElevations=function(n){var t,i,r;n=extend_object({locations:[],path:!1,samples:256},n);n.locations.length>0&&n.locations[0].length>0&&(n.locations=array_flat(array_map([n.locations],arrayToLatLng,!1)));t=n.callback;delete n.callback;i=new google.maps.ElevationService;n.path?(r={path:n.locations,samples:n.samples},i.getElevationAlongPath(r,function(n,i){t&&typeof t=="function"&&t(n,i)})):(delete n.path,delete n.samples,i.getElevationForLocations(n,function(n,i){t&&typeof t=="function"&&t(n,i)}))};GMaps.prototype.cleanRoute=GMaps.prototype.removePolylines;GMaps.prototype.drawRoute=function(n){var t=this;this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,unitSystem:n.unitSystem,callback:function(i){i.length>0&&(t.drawPolyline({path:i[i.length-1].overview_path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.callback&&n.callback(i[i.length-1]))}})};GMaps.prototype.travelRoute=function(n){var r,t,i;if(n.origin&&n.destination)this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,callback:function(t){var i,f,r,u;if(t.length>0&&n.start&&n.start(t[t.length-1]),t.length>0&&n.step&&(i=t[t.length-1],i.legs.length>0))for(f=i.legs[0].steps,r=0;u=f[r];r++)u.step_number=r,n.step(u,i.legs[0].steps.length-1);t.length>0&&n.end&&n.end(t[t.length-1])}});else if(n.route&&n.route.legs.length>0)for(r=n.route.legs[0].steps,t=0;i=r[t];t++)i.step_number=t,n.step(i)};GMaps.prototype.drawSteppedRoute=function(n){var r=this,u,t,i;if(n.origin&&n.destination)this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,callback:function(t){var i,e,u,f;if(t.length>0&&n.start&&n.start(t[t.length-1]),t.length>0&&n.step&&(i=t[t.length-1],i.legs.length>0))for(e=i.legs[0].steps,u=0;f=e[u];u++)f.step_number=u,r.drawPolyline({path:f.path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.step(f,i.legs[0].steps.length-1);t.length>0&&n.end&&n.end(t[t.length-1])}});else if(n.route&&n.route.legs.length>0)for(u=n.route.legs[0].steps,t=0;i=u[t];t++)i.step_number=t,r.drawPolyline({path:i.path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.step(i)};GMaps.Route=function(n){this.origin=n.origin;this.destination=n.destination;this.waypoints=n.waypoints;this.map=n.map;this.route=n.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}).getPath()};GMaps.Route.prototype.getRoute=function(n){var t=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:n.travelMode,waypoints:this.waypoints||[],callback:function(){t.route=e[0];n.callback&&n.callback.call(t)}})};GMaps.Route.prototype.back=function(){var n,t;if(this.step_count>0){this.step_count--;n=this.route.legs[0].steps[this.step_count].path;for(t in n)n.hasOwnProperty(t)&&this.polyline.pop()}};GMaps.Route.prototype.forward=function(){var n,t;if(this.step_count<this.steps_length){n=this.route.legs[0].steps[this.step_count].path;for(t in n)n.hasOwnProperty(t)&&this.polyline.push(n[t]);this.step_count++}};GMaps.prototype.checkGeofence=function(n,t,i){return i.containsLatLng(new google.maps.LatLng(n,t))};GMaps.prototype.checkMarkerGeofence=function(n,t){var i,r,u;if(n.fences)for(i=0;r=n.fences[i];i++)u=n.getPosition(),this.checkGeofence(u.lat(),u.lng(),r)||t(n,r)};GMaps.prototype.toImage=function(n){var n=n||{},t={},i,r;if(t.size=n.size||[this.el.clientWidth,this.el.clientHeight],t.lat=this.getCenter().lat(),t.lng=this.getCenter().lng(),this.markers.length>0)for(t.markers=[],i=0;i<this.markers.length;i++)t.markers.push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()});return this.polylines.length>0&&(r=this.polylines[0],t.polyline={},t.polyline.path=google.maps.geometry.encoding.encodePath(r.getPath()),t.polyline.strokeColor=r.strokeColor,t.polyline.strokeOpacity=r.strokeOpacity,t.polyline.strokeWeight=r.strokeWeight),GMaps.staticMapURL(t)};GMaps.staticMapURL=function(n){function g(n,t){if(n[0]==="#"&&(n=n.replace("#","0x"),t)){if(t=parseFloat(t),t=Math.min(1,Math.max(t,0)),t===0)return"0x00000000";t=(t*255).toString(16);t.length===1&&(t+=t);n=n.slice(0,8)+t}return n}var r=[],t,p="http://maps.googleapis.com/maps/api/staticmap",c,f,e,k,h,d,u,w,o,i,l,a,v,b,nt,tt,y,s,it;n.url&&(p=n.url,delete n.url);p+="?";c=n.markers;delete n.markers;!c&&n.marker&&(c=[n.marker],delete n.marker);f=n.styles;delete n.styles;e=n.polyline;delete n.polyline;n.center?(r.push("center="+n.center),delete n.center):n.address?(r.push("center="+n.address),delete n.address):n.lat?(r.push(["center=",n.lat,",",n.lng].join("")),delete n.lat,delete n.lng):n.visible&&(k=encodeURI(n.visible.join("|")),r.push("visible="+k));h=n.size;h?(h.join&&(h=h.join("x")),delete n.size):h="630x300";r.push("size="+h);n.zoom||n.zoom===!1||(n.zoom=15);d=n.hasOwnProperty("sensor")?!!n.sensor:!0;delete n.sensor;r.push("sensor="+d);for(o in n)n.hasOwnProperty(o)&&r.push(o+"="+n[o]);if(c)for(i=0;t=c[i];i++){u=[];t.size&&t.size!=="normal"?(u.push("size:"+t.size),delete t.size):t.icon&&(u.push("icon:"+encodeURI(t.icon)),delete t.icon);t.color&&(u.push("color:"+t.color.replace("#","0x")),delete t.color);t.label&&(u.push("label:"+t.label[0].toUpperCase()),delete t.label);w=t.address?t.address:t.lat+","+t.lng;delete t.address;delete t.lat;delete t.lng;for(o in t)t.hasOwnProperty(o)&&u.push(o+":"+t[o]);u.length||i===0?(u.push(w),u=u.join("|"),r.push("markers="+encodeURI(u))):(u=r.pop()+encodeURI("|"+w),r.push(u))}if(f)for(i=0;i<f.length;i++){for(l=[],f[i].featureType&&f[i].featureType!="all"&&l.push("feature:"+f[i].featureType),f[i].elementType&&f[i].elementType!="all"&&l.push("element:"+f[i].elementType),s=0;s<f[i].stylers.length;s++)for(a in f[i].stylers[s])v=f[i].stylers[s][a],(a=="hue"||a=="color")&&(v="0x"+v.substring(1)),l.push(a+":"+v);b=l.join("|");b!=""&&r.push("style="+b)}if(e){if(t=e,e=[],t.strokeWeight&&e.push("weight:"+parseInt(t.strokeWeight,10)),t.strokeColor&&(nt=g(t.strokeColor,t.strokeOpacity),e.push("color:"+nt)),t.fillColor&&(tt=g(t.fillColor,t.fillOpacity),e.push("fillcolor:"+tt)),y=t.path,y.join)for(s=0;it=y[s];s++)e.push(it.join(","));else e.push("enc:"+y);e=e.join("|");r.push("path="+encodeURI(e))}return r=r.join("&"),p+r};GMaps.prototype.addMapType=function(n,t){if(t.hasOwnProperty("getTileUrl")&&typeof t.getTileUrl=="function"){t.tileSize=t.tileSize||new google.maps.Size(256,256);var i=new google.maps.ImageMapType(t);this.map.mapTypes.set(n,i)}else throw"'getTileUrl' function required.";};GMaps.prototype.addOverlayMapType=function(n){if(n.hasOwnProperty("getTile")&&typeof n.getTile=="function"){var t=n.index;delete n.index;this.map.overlayMapTypes.insertAt(t,n)}else throw"'getTile' function required.";};GMaps.prototype.removeOverlayMapType=function(n){this.map.overlayMapTypes.removeAt(n)};GMaps.prototype.addStyle=function(n){var t=new google.maps.StyledMapType(n.styles,{name:n.styledMapName});this.map.mapTypes.set(n.mapTypeId,t)};GMaps.prototype.setStyle=function(n){this.map.setMapTypeId(n)};GMaps.prototype.createPanorama=function(n){return n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")||(n.lat=this.getCenter().lat(),n.lng=this.getCenter().lng()),this.panorama=GMaps.createPanorama(n),this.map.setStreetView(this.panorama),this.panorama};GMaps.createPanorama=function(n){var f=getElementById(n.el,n.context),i,r,u,t;for(n.position=new google.maps.LatLng(n.lat,n.lng),delete n.el,delete n.context,delete n.lat,delete n.lng,i=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],r=extend_object({visible:!0},n),t=0;t<i.length;t++)delete r[i[t]];for(u=new google.maps.StreetViewPanorama(f,r),t=0;t<i.length;t++)(function(t,i){n[i]&&google.maps.event.addListener(t,i,function(){n[i].apply(this)})})(u,i[t]);return u};GMaps.prototype.on=function(n,t){return GMaps.on(n,this,t)};GMaps.prototype.off=function(n){GMaps.off(n,this)};GMaps.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"];GMaps.on=function(n,t,i){if(GMaps.custom_events.indexOf(n)==-1)return google.maps.event.addListener(t,n,i);var r={handler:i,eventName:n};return t.registered_events[n]=t.registered_events[n]||[],t.registered_events[n].push(r),r};GMaps.off=function(n,t){GMaps.custom_events.indexOf(n)==-1?google.maps.event.clearListeners(t,n):t.registered_events[n]=[]};GMaps.fire=function(n,t,i){var u,r;if(GMaps.custom_events.indexOf(n)==-1)google.maps.event.trigger(t,n,Array.prototype.slice.apply(arguments).slice(2));else if(n in i.registered_events)for(u=i.registered_events[n],r=0;r<u.length;r++)(function(n,t,i){n.apply(t,[i])})(u[r].handler,i,t)};GMaps.geolocate=function(n){var t=n.always||n.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){n.success(i);t&&t()},function(i){n.error(i);t&&t()},n.options):(n.not_supported(),t&&t())};GMaps.geocode=function(n){this.geocoder=new google.maps.Geocoder;var t=n.callback;n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")&&(n.latLng=new google.maps.LatLng(n.lat,n.lng));delete n.lat;delete n.lng;delete n.callback;this.geocoder.geocode(n,function(n,i){t(n,i)})};google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){for(var n,r=new google.maps.LatLngBounds,u=this.getPaths(),t,i=0;i<u.getLength();i++)for(t=u.getAt(i),n=0;n<t.getLength();n++)r.extend(t.getAt(n));return r});google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(n){var o=this.getBounds(),u,s,f,i,t,r;if(o!==null&&!o.contains(n))return!1;for(u=!1,s=this.getPaths().getLength(),f=0;f<s;f++){var e=this.getPaths().getAt(f),h=e.getLength(),c=h-1;for(i=0;i<h;i++)t=e.getAt(i),r=e.getAt(c),(t.lng()<n.lng()&&r.lng()>=n.lng()||r.lng()<n.lng()&&t.lng()>=n.lng())&&t.lat()+(n.lng()-t.lng())/(r.lng()-t.lng())*(r.lat()-t.lat())<n.lat()&&(u=!u),c=i}return u});google.maps.LatLngBounds.prototype.containsLatLng=function(n){return this.contains(n)};google.maps.Marker.prototype.setFences=function(n){this.fences=n};google.maps.Marker.prototype.addFence=function(n){this.fences.push(n)};google.maps.Marker.prototype.getId=function(){return this.__gm_id};Array.prototype.indexOf||(Array.prototype.indexOf=function(n){"use strict";var u,r,t,i;if(this==null)throw new TypeError;if((u=Object(this),r=u.length>>>0,r===0)||(t=0,arguments.length>1&&(t=Number(arguments[1]),t!=t?t=0:t!=0&&t!=Infinity&&t!=-Infinity&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r))return-1;for(i=t>=0?t:Math.max(r-Math.abs(t),0);i<r;i++)if(i in u&&u[i]===n)return i;return-1});